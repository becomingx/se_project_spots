!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn--disabled",inputErrorClass:"modal__error_input",errorClass:"modal__error--visible",errorClassHidden:"modal__error--hidden"},t=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),t.classList.remove(r.errorClass),o&&(o.textContent="")},r=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},o=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?r(t,o):(t.disabled=!1,t.classList.remove(o.inactiveButtonClass))},a=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((r=>{((e,r)=>{const a=Array.from(e.querySelectorAll(r.inputSelector)),n=e.querySelector(r.submitButtonSelector);o(a,n,r),a.forEach((s=>{s.addEventListener("input",(()=>{((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{const a=e.querySelector(`#${t.id}`),n=e.querySelector(`#${a.id}-error`);n&&(t.classList.add(o.inputErrorClass),t.classList.add(o.errorClass),n.textContent=r)})(e,r,r.validationMessage,o)})(e,s,r),o(a,n,r)}))}))})(r,e),r.addEventListener("submit",(e=>{e.preventDefault()}))}))};function n(e,t,r="Save",o="Saving..."){e.textContent=t?o:r}a(e);const s=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getUserCards(),this.getUserInfo()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}editUserAvatar({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}getUserCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}createCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e:Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}toggleLikeCard(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>e.ok?e:Promise.reject(e.status))).catch((e=>{if(e)return console.error(e),Promise.reject(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"30487a64-5f71-41bb-bbbd-2f7240ebc0c2","content-Type":"application/json"}}),c=document.querySelector(".profile__avatar"),l=document.querySelector(".profile__name"),i=document.querySelector(".profile__description"),d=document.querySelector(".profile__add-btn"),u=document.querySelector(".profile__edit-btn"),m=document.querySelector("#edit-avatar-modal"),_=document.querySelector(".profile__edit-avatar-btn"),h=m.querySelector(".modal__form"),v=m.querySelector(".modal__close-btn"),y=m.querySelector("#edit-avatar-url-input"),b=m.querySelector(".modal__submit-btn"),S=document.querySelector("#edit-modal"),f=S.querySelector(".modal__form"),p=S.querySelector(".modal__close-btn"),q=S.querySelector("#profile-name-input"),E=S.querySelector("#profile-description-input"),L=S.querySelector(".modal__submit-btn"),k=document.querySelector("#add-card-modal"),C=k.querySelector(".modal__form"),g=k.querySelector(".modal__close-btn"),j=k.querySelector("#add-card-link-input"),P=k.querySelector("#add-card-name-input"),U=k.querySelector(".modal__submit-btn"),$=document.querySelector("#preview-modal"),x=$.querySelector(".modal__image"),A=$.querySelector(".modal__preview-caption"),D=$.querySelector(".modal__close-btn--preview"),w=document.querySelector("#delete-card-modal"),T=w.querySelector(".modal__cancel-btn"),I=w.querySelector(".modal__submit-btn"),B=w.querySelector(".modal__close-btn"),N=w.querySelector(".modal__form"),O=document.querySelector("#card-template"),H=document.querySelector(".cards__list");let J,z;const M=e=>{const t=O.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),a=t.querySelector(".card__like-btn"),n=t.querySelector(".card__delete-btn");return r.textContent=e.name,o.src=e.link,o.alt=e.name,a.addEventListener("click",(t=>{V(t,e._id)})),n.addEventListener("click",(()=>{K(w)})),I.addEventListener("submit",(()=>{t.remove()})),T.addEventListener("click",(()=>{Q(w)})),B.addEventListener("click",(()=>{Q(w)})),n.addEventListener("click",(r=>{R(t,e)})),o.addEventListener("click",(()=>{K($),A.textContent=e.name,x.alt=e.name,x.src=e.link})),t},F=e=>{if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&Q(e)}},G=e=>{e.target.classList.contains("modal_opened")&&Q(e.target)},K=e=>{e.classList.add("modal_opened"),document.addEventListener("keydown",F),e.addEventListener("mousedown",G)},Q=e=>{e.classList.remove("modal_opened"),document.removeEventListener("keydown",F),e.removeEventListener("mousedown",G)},R=(e,t)=>{J=e,z=t._id,K(w)},V=(e,t)=>{const r=e.target.classList.contains("card__like-btn-liked");s.toggleLikeCard(t,r).then((t=>{e.target.classList.toggle("card__like-btn-liked")})).catch((e=>{console.error("Error liking card:",e)}))};I.addEventListener("click",(()=>{K(w)})),_.addEventListener("click",(()=>{K(m)})),d.addEventListener("click",(()=>{K(k)})),u.addEventListener("click",(()=>{q.value=l.textContent,E.value=i.textContent,K(S),((e,o,a,n)=>{o.forEach((r=>{t(e,r,n)})),r(a,n)})(S,[q,E],L,e)})),D.addEventListener("click",(()=>{Q($)})),g.addEventListener("click",(()=>{Q(k)})),p.addEventListener("click",(()=>{Q(S)})),v.addEventListener("click",(()=>{Q(m)})),T.addEventListener("click",(()=>{Q(w)})),B.addEventListener("click",(()=>{Q(w)})),f.addEventListener("submit",(e=>{e.preventDefault();const t=L;n(t,!0),s.editUserInfo({name:q.value,about:E.value}).then((e=>{l.textContent=e.name,i.textContent=e.about,Q(S)})).catch(console.error).finally((()=>{n(t,!1)}))})),C.addEventListener("submit",(t=>{t.preventDefault();const o=U;n(o,!0);const a={name:P.value,link:j.value};s.createCard(a).then((o=>{const a=M(o);H.prepend(a),t.target.reset(),Q(k),r(U,e)})).catch((e=>{console.error("Error creating card:",e)})).finally((()=>{n(o,!1)}))})),h.addEventListener("submit",(e=>{e.preventDefault();const t=b;n(t,!0),s.editUserAvatar({avatar:y.value}).then((e=>{c.src=e.avatar,Q(m)})).catch(console.error).finally((()=>{n(t,!1)}))})),N.addEventListener("submit",(()=>{const e=I;n(e,!0,"Delete","Deleting..."),s.removeCard(z).then((()=>{J.remove(),Q(w)})).catch(console.error).finally((()=>{n(e,!1,"Delete","Deleting...")}))})),s.getAppInfo().then((([e,t])=>{e.forEach((e=>{const t=M(e);H.append(t)})),l.textContent=t.name,i.textContent=t.about,c.src=t.avatar})).catch(console.error),a(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQUEsTUFBTUEsRUFBVyxDQUNmQyxhQUFjLGVBQ2RDLGNBQWUsZ0JBQ2ZDLHFCQUFzQixxQkFDdEJDLG9CQUFxQiw4QkFDckJDLGdCQUFpQixxQkFDakJDLFdBQVksd0JBQ1pDLGlCQUFrQix3QkFjZEMsRUFBaUJBLENBQUNDLEVBQWFDLEVBQWNWLEtBQ2pELE1BQU1XLEVBQXNCRixFQUFZRyxjQUFjLElBQUlGLEVBQWFHLFlBQ3ZFSCxFQUFhSSxVQUFVQyxPQUFPZixFQUFTSyxpQkFDdkNLLEVBQWFJLFVBQVVDLE9BQU9mLEVBQVNNLFlBR25DSyxJQUNGQSxFQUFvQkssWUFBYyxLQWdCaENDLEVBQWdCQSxDQUFDQyxFQUFlbEIsS0FDcENrQixFQUFjSixVQUFVSyxJQUFJbkIsRUFBU0kscUJBQ3JDYyxFQUFjRSxVQUFXLEdBR3JCQyxFQUFvQkEsQ0FBQ0MsRUFBV0osRUFBZWxCLEtBVDVCc0IsSUFDaEJBLEVBQVVDLE1BQU1DLElBQVdBLEVBQU1DLFNBQVNDLFFBUzdDQyxDQUFnQkwsR0FDbEJMLEVBQWNDLEVBQWVsQixJQUU3QmtCLEVBQWNFLFVBQVcsRUFDekJGLEVBQWNKLFVBQVVDLE9BQU9mLEVBQVNJLHVCQTJCdEN3QixFQUFvQjVCLElBQ1A2QixNQUFNQyxLQUFLQyxTQUFTQyxpQkFBaUJoQyxFQUFTQyxlQUV0RGdDLFNBQVN4QixJQTFCTXlCLEVBQUN6QixFQUFhVCxLQUN0QyxNQUFNc0IsRUFBWU8sTUFBTUMsS0FDdEJyQixFQUFZdUIsaUJBQWlCaEMsRUFBU0UsZ0JBRWxDZ0IsRUFBZ0JULEVBQVlHLGNBQWNaLEVBQVNHLHNCQUV6RGtCLEVBQWtCQyxFQUFXSixFQUFlbEIsR0FFNUNzQixFQUFVVyxTQUFTdkIsSUFDakJBLEVBQWF5QixpQkFBaUIsU0FBUyxLQW5DaEJDLEVBQUMzQixFQUFhQyxFQUFjVixLQUNoRFUsRUFBYWUsU0FBU0MsTUFHekJsQixFQUFlQyxFQUFhQyxFQUFjVixHQTFCdkJxQyxFQUFDNUIsRUFBYUMsRUFBYzRCLEVBQWN0QyxLQUMvRCxNQUFNdUMsRUFBdUI5QixFQUFZRyxjQUFjLElBQUlGLEVBQWFHLE1BQ2xFRixFQUFzQkYsRUFBWUcsY0FBYyxJQUFJMkIsRUFBcUIxQixZQUUzRUYsSUFDRkQsRUFBYUksVUFBVUssSUFBSW5CLEVBQVNLLGlCQUNwQ0ssRUFBYUksVUFBVUssSUFBSW5CLEVBQVNNLFlBQ3BDSyxFQUFvQkssWUFBY3NCLElBaUJsQ0QsQ0FBZTVCLEVBQWFDLEVBQWNBLEVBQWE4QixrQkFBbUJ4QyxJQWtDeEVvQyxDQUFtQjNCLEVBQWFDLEVBQWNWLEdBQzlDcUIsRUFBa0JDLEVBQVdKLEVBQWVsQixVQWdCOUNrQyxDQUFrQnpCLEVBQWFULEdBQy9CUyxFQUFZMEIsaUJBQWlCLFVBQVdNLElBQ3RDQSxFQUFJQyx3QkN2RkgsU0FBU0MsRUFDWkMsRUFDQUMsRUFDQUMsRUFBYyxPQUNkQyxFQUFjLGFBR1ZILEVBQUk1QixZQURKNkIsRUFDa0JFLEVBRUFELENBRTFCLENEaUZBbEIsRUFBaUI1QixHRTVFakIsTUFBTWdELEVBQU8sSUNoQmIsTUFDSUMsV0FBQUEsRUFBWSxRQUFDQyxFQUFPLFFBQUVDLElBQ3BCQyxLQUFLQyxTQUFXSCxFQUNoQkUsS0FBS0UsU0FBV0gsQ0FDbEIsQ0FFQUksVUFBQUEsR0FDSSxPQUFPQyxRQUFRQyxJQUFJLENBQUNMLEtBQUtNLGVBQWdCTixLQUFLTyxlQUNsRCxDQUdBQSxXQUFBQSxHQUNJLE9BQU9DLE1BQU0sR0FBR1IsS0FBS0Msb0JBQ2pCLENBQ0lGLFFBQVNDLEtBQUtFLFdBRWpCTyxNQUFNQyxHQUNDQSxFQUFJQyxHQUNERCxFQUFJRSxPQUVSUixRQUFRUyxPQUFPSCxFQUFJSSxVQUV6QkMsT0FBT0MsSUFDSixHQUFJQSxFQUVBLE9BREFDLFFBQVFDLE1BQU1GLEdBQ1BaLFFBQVFTLE9BQU9HLEtBR3RDLENBRUFHLFlBQUFBLEVBQWEsS0FBQ0MsRUFBSSxNQUFFQyxJQUNoQixPQUFPYixNQUFNLEdBQUdSLEtBQUtDLG9CQUNqQixDQUNJcUIsT0FBUSxRQUNSdkIsUUFBU0MsS0FBS0UsU0FDZHFCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakJMLE9BQ0FDLFlBR1BaLE1BQU1DLEdBQ0NBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJSLFFBQVFTLE9BQU9ILEVBQUlJLFVBRTdCQyxPQUFPQyxJQUNKLEdBQUlBLEVBRUEsT0FEQUMsUUFBUUMsTUFBTUYsR0FDUFosUUFBUVMsT0FBT0csS0FHdEMsQ0FFQVUsY0FBQUEsRUFBZSxPQUFDQyxJQUNaLE9BQU9uQixNQUFNLEdBQUdSLEtBQUtDLDJCQUNqQixDQUNJcUIsT0FBUSxRQUNSdkIsUUFBU0MsS0FBS0UsU0FDZHFCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakJFLGFBR1BsQixNQUFNQyxHQUNDQSxFQUFJQyxHQUNHRCxFQUFJRSxPQUVSUixRQUFRUyxPQUFPSCxFQUFJSSxVQUU3QkMsT0FBT0MsSUFDSixHQUFJQSxFQUVBLE9BREFDLFFBQVFDLE1BQU1GLEdBQ1BaLFFBQVFTLE9BQU9HLEtBR3RDLENBRUFWLFlBQUFBLEdBQ0ksT0FBT0UsTUFBTSxHQUFHUixLQUFLQyxpQkFDakIsQ0FDSUYsUUFBU0MsS0FBS0UsV0FFakJPLE1BQU1DLEdBQ0NBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJSLFFBQVFTLE9BQU9ILEVBQUlJLFVBRTdCQyxPQUFPQyxJQUNKLEdBQUlBLEVBRUEsT0FEQUMsUUFBUUMsTUFBTUYsR0FDUFosUUFBUVMsT0FBT0csS0FHdEMsQ0FFQVksVUFBQUEsRUFBVyxLQUFDUixFQUFJLEtBQUVTLElBQ2QsT0FBT3JCLE1BQU0sR0FBR1IsS0FBS0MsaUJBQ2pCLENBQ0lxQixPQUFRLE9BQ1J2QixRQUFTQyxLQUFLRSxTQUNkcUIsS0FBTUMsS0FBS0MsVUFBVSxDQUNqQkwsT0FDQVMsV0FHUHBCLE1BQU1DLEdBQ0NBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJSLFFBQVFTLE9BQU9ILEVBQUlJLFVBRTdCQyxPQUFPQyxJQUNQLEdBQUlBLEVBRUQsT0FEQUMsUUFBUUMsTUFBTUYsR0FDUFosUUFBUVMsT0FBT0csS0FHbEMsQ0FFQWMsVUFBQUEsQ0FBV0MsR0FDUCxPQUFPdkIsTUFBTSxHQUFHUixLQUFLQyxrQkFBa0I4QixJQUNuQyxDQUNJVCxPQUFRLFNBQ1J2QixRQUFTQyxLQUFLRSxXQUVqQk8sTUFBTUMsR0FDQ0EsRUFBSUMsR0FDR0QsRUFFSk4sUUFBUVMsT0FBT0gsRUFBSUksVUFFN0JDLE9BQU9DLElBQ0osR0FBSUEsRUFFQSxPQURBQyxRQUFRQyxNQUFNRixHQUNQWixRQUFRUyxPQUFPRyxLQUd0QyxDQUdBZ0IsY0FBQUEsQ0FBZUQsRUFBS0UsR0FDaEIsT0FBT3pCLE1BQU0sR0FBR1IsS0FBS0Msa0JBQWtCOEIsVUFDbkMsQ0FDSVQsT0FBUVcsRUFBVSxTQUFXLE1BQzdCbEMsUUFBU0MsS0FBS0UsV0FFakJPLE1BQU1DLEdBQ0NBLEVBQUlDLEdBQ0dELEVBRUpOLFFBQVFTLE9BQU9ILEVBQUlJLFVBRTdCQyxPQUFPQyxJQUNKLEdBQUlBLEVBRUEsT0FEQUMsUUFBUUMsTUFBTUYsR0FDUFosUUFBUVMsT0FBT0csS0FHdEMsR0QvSWlCLENBQ25CbEIsUUFBUyxrREFDVEMsUUFBUyxDQUNQbUMsY0FBZSx1Q0FDZixlQUFnQixzQkFJZEMsRUFBZ0J4RCxTQUFTbkIsY0FBYyxvQkFDdkM0RSxFQUFjekQsU0FBU25CLGNBQWMsa0JBQ3JDNkUsRUFBcUIxRCxTQUFTbkIsY0FBYyx5QkFDNUM4RSxFQUFnQjNELFNBQVNuQixjQUFjLHFCQUN2QytFLEVBQWlCNUQsU0FBU25CLGNBQWMsc0JBRXhDZ0YsRUFBYzdELFNBQVNuQixjQUFjLHNCQUNyQ2lGLEVBQWlCOUQsU0FBU25CLGNBQWMsNkJBQ3hDa0YsRUFBeUJGLEVBQVloRixjQUFjLGdCQUNuRG1GLEVBQXNCSCxFQUFZaEYsY0FBYyxxQkFDaERvRixFQUFzQkosRUFBWWhGLGNBQWMsMEJBQ2hEcUYsRUFBdUJMLEVBQVloRixjQUFjLHNCQUVqRHNGLEVBQVluRSxTQUFTbkIsY0FBYyxlQUNuQ3VGLEVBQXVCRCxFQUFVdEYsY0FBYyxnQkFDL0N3RixFQUFvQkYsRUFBVXRGLGNBQWMscUJBQzVDeUYsRUFBcUJILEVBQVV0RixjQUFjLHVCQUM3QzBGLEVBQTRCSixFQUFVdEYsY0FBYyw4QkFDcEQyRixFQUFxQkwsRUFBVXRGLGNBQWMsc0JBRTdDNEYsRUFBV3pFLFNBQVNuQixjQUFjLG1CQUNsQzZGLEVBQXNCRCxFQUFTNUYsY0FBYyxnQkFDN0M4RixFQUFtQkYsRUFBUzVGLGNBQWMscUJBQzFDK0YsRUFBb0JILEVBQVM1RixjQUFjLHdCQUMzQ2dHLEVBQW9CSixFQUFTNUYsY0FBYyx3QkFDM0NpRyxFQUFvQkwsRUFBUzVGLGNBQWMsc0JBRTNDa0csRUFBZS9FLFNBQVNuQixjQUFjLGtCQUN0Q21HLEVBQTJCRCxFQUFhbEcsY0FBYyxpQkFDdERvRyxFQUFzQkYsRUFBYWxHLGNBQWMsMkJBQ2pEcUcsRUFBdUJILEVBQWFsRyxjQUFjLDhCQUVsRHNHLEVBQWtCbkYsU0FBU25CLGNBQWMsc0JBQ3pDdUcsRUFBMkJELEVBQWdCdEcsY0FBYyxzQkFDekR3RyxFQUFxQkYsRUFBZ0J0RyxjQUFjLHNCQUNuRHlHLEVBQTBCSCxFQUFnQnRHLGNBQWMscUJBQ3hEMEcsRUFBc0JKLEVBQWdCdEcsY0FBYyxnQkFFcEQyRyxFQUFleEYsU0FBU25CLGNBQWMsa0JBQ3RDNEcsRUFBWXpGLFNBQVNuQixjQUFjLGdCQUV6QyxJQUFJNkcsRUFDQUMsRUFFSixNQUFNQyxFQUFrQkMsSUFDdEIsTUFBTUMsRUFBY04sRUFBYU8sUUFDaENsSCxjQUFjLFNBQ2RtSCxXQUFVLEdBRUxDLEVBQWtCSCxFQUFZakgsY0FBYyxnQkFDNUNxSCxFQUFtQkosRUFBWWpILGNBQWMsZ0JBQzdDc0gsRUFBVUwsRUFBWWpILGNBQWMsbUJBQ3BDdUgsRUFBWU4sRUFBWWpILGNBQWMscUJBb0M1QyxPQWxDQW9ILEVBQWdCaEgsWUFBYzRHLEVBQUtwRCxLQUNuQ3lELEVBQWlCRyxJQUFNUixFQUFLM0MsS0FDNUJnRCxFQUFpQkksSUFBTVQsRUFBS3BELEtBRTVCMEQsRUFBUS9GLGlCQUFpQixTQUFVTSxJQUNqQzZGLEVBQW9CN0YsRUFBS21GLEVBQUt6QyxRQUdoQ2dELEVBQVVoRyxpQkFBaUIsU0FBUyxLQUNsQ29HLEVBQVVyQixNQUdaRSxFQUFtQmpGLGlCQUFpQixVQUFVLEtBQzVDMEYsRUFBWTlHLFlBR2RvRyxFQUF5QmhGLGlCQUFpQixTQUFTLEtBQ2pEcUcsRUFBV3RCLE1BR2JHLEVBQXdCbEYsaUJBQWlCLFNBQVMsS0FDaERxRyxFQUFXdEIsTUFFYmlCLEVBQVVoRyxpQkFBaUIsU0FBVU0sSUFDbkNnRyxFQUFpQlosRUFBYUQsTUFHaENLLEVBQWlCOUYsaUJBQWlCLFNBQVMsS0FDekNvRyxFQUFVekIsR0FDVkUsRUFBb0JoRyxZQUFjNEcsRUFBS3BELEtBQ3ZDdUMsRUFBeUJzQixJQUFNVCxFQUFLcEQsS0FDcEN1QyxFQUF5QnFCLElBQU1SLEVBQUszQyxRQUcvQjRDLEdBS0hhLEVBQW1CakcsSUFDdkIsR0FBZ0IsV0FBWkEsRUFBSWtHLElBQWtCLENBQ3hCLE1BQU1DLEVBQWM3RyxTQUFTbkIsY0FBYyxpQkFDdkNnSSxHQUNGSixFQUFXSSxFQUVmLEdBR0lDLEVBQXNCcEcsSUFDdEJBLEVBQUlxRyxPQUFPaEksVUFBVWlJLFNBQVMsaUJBQ2hDUCxFQUFXL0YsRUFBSXFHLFNBSWJQLEVBQWFTLElBQ2pCQSxFQUFNbEksVUFBVUssSUFBSSxnQkFDcEJZLFNBQVNJLGlCQUFpQixVQUFXdUcsR0FDckNNLEVBQU03RyxpQkFBaUIsWUFBYTBHLElBR2hDTCxFQUFjUSxJQUNsQkEsRUFBTWxJLFVBQVVDLE9BQU8sZ0JBQ3ZCZ0IsU0FBU2tILG9CQUFvQixVQUFXUCxHQUN4Q00sRUFBTUMsb0JBQW9CLFlBQWFKLElBK0RuQ0osRUFBbUJBLENBQUNaLEVBQWFELEtBQ3JDSCxFQUFlSSxFQUNmSCxFQUFpQkUsRUFBS3pDLElBQ3RCb0QsRUFBVXJCLElBa0JOb0IsRUFBc0JBLENBQUM3RixFQUFLeUcsS0FDaEMsTUFBTTdELEVBQVU1QyxFQUFJcUcsT0FBT2hJLFVBQVVpSSxTQUFTLHdCQUM5Qy9GLEVBQUlvQyxlQUFlOEQsRUFBUTdELEdBQ3hCeEIsTUFBTXNGLElBQ0wxRyxFQUFJcUcsT0FBT2hJLFVBQVVzSSxPQUFPLDJCQUU3QmpGLE9BQU9HLElBQ05ELFFBQVFDLE1BQU0scUJBQXNCQSxPQUsxQzhDLEVBQW1CakYsaUJBQWlCLFNBQVMsS0FDM0NvRyxFQUFVckIsTUFFWnJCLEVBQWUxRCxpQkFBaUIsU0FBUyxLQUN2Q29HLEVBQVUzQyxNQUVaRixFQUFjdkQsaUJBQWlCLFNBQVMsS0FDdENvRyxFQUFVL0IsTUFFWmIsRUFBZXhELGlCQUFpQixTQUFTLEtBQ3ZDa0UsRUFBbUJnRCxNQUFRN0QsRUFBWXhFLFlBQ3ZDc0YsRUFBMEIrQyxNQUFRNUQsRUFBbUJ6RSxZQUNyRHVILEVBQVVyQyxHRi9LWW9ELEVBQUM3SSxFQUFhYSxFQUFXSixFQUFlbEIsS0FDOURzQixFQUFVVyxTQUFTVCxJQUNqQmhCLEVBQWVDLEVBQWFlLEVBQU94QixNQUVyQ2lCLEVBQWNDLEVBQWVsQixJRTRLN0JzSixDQUFnQnBELEVBQVcsQ0FBQ0csRUFBb0JDLEdBQTRCQyxFQUFvQnZHLE1BRWxHaUgsRUFBcUI5RSxpQkFBaUIsU0FBUyxLQUM3Q3FHLEVBQVcxQixNQUViSixFQUFpQnZFLGlCQUFpQixTQUFTLEtBQ3pDcUcsRUFBV2hDLE1BRWJKLEVBQWtCakUsaUJBQWlCLFNBQVMsS0FDMUNxRyxFQUFXdEMsTUFFYkgsRUFBb0I1RCxpQkFBaUIsU0FBUSxLQUMzQ3FHLEVBQVc1QyxNQUVidUIsRUFBeUJoRixpQkFBaUIsU0FBUyxLQUNqRHFHLEVBQVd0QixNQUViRyxFQUF3QmxGLGlCQUFpQixTQUFTLEtBQ2hEcUcsRUFBV3RCLE1BRWJmLEVBQXFCaEUsaUJBQWlCLFVBOUdITSxJQUNqQ0EsRUFBSUMsaUJBQ0osTUFBTTZHLEVBQWFoRCxFQUNuQjVELEVBQWtCNEcsR0FBWSxHQUU5QnZHLEVBQUl1QixhQUFhLENBQUNDLEtBQU02QixFQUFtQmdELE1BQU81RSxNQUFPNkIsRUFBMEIrQyxRQUNsRnhGLE1BQU0rRCxJQUNMcEMsRUFBWXhFLFlBQWM0RyxFQUFLcEQsS0FDL0JpQixFQUFtQnpFLFlBQWM0RyxFQUFLbkQsTUFDdEMrRCxFQUFXdEMsTUFFWi9CLE1BQU1FLFFBQVFDLE9BQ2RrRixTQUFRLEtBQ1A3RyxFQUFrQjRHLEdBQVksU0FrR2xDOUMsRUFBb0J0RSxpQkFBaUIsVUE3RkhNLElBQ2hDQSxFQUFJQyxpQkFDSixNQUFNK0csRUFBWTVDLEVBQ2xCbEUsRUFBa0I4RyxHQUFXLEdBRTdCLE1BQU1DLEVBQWMsQ0FDbEJsRixLQUFNb0MsRUFBa0J5QyxNQUN4QnBFLEtBQU0wQixFQUFrQjBDLE9BRzFCckcsRUFBSWdDLFdBQVcwRSxHQUNaN0YsTUFBTThGLElBQ0wsTUFBTUMsRUFBaUJqQyxFQUFlZ0MsR0FDdENuQyxFQUFVcUMsUUFBUUQsR0FDbEJuSCxFQUFJcUcsT0FBT2dCLFFBQ1h0QixFQUFXaEMsR0FDWHZGLEVBQWM0RixFQUFtQjdHLE1BRWxDbUUsT0FBT0csSUFDTkQsUUFBUUMsTUFBTSx1QkFBd0JBLE1BRXZDa0YsU0FBUSxLQUNQN0csRUFBa0I4RyxHQUFXLFNBd0VuQzNELEVBQXVCM0QsaUJBQWlCLFVBaElITSxJQUNuQ0EsRUFBSUMsaUJBQ0osTUFBTXFILEVBQWU5RCxFQUNyQnRELEVBQWtCb0gsR0FBYyxHQUVoQy9HLEVBQUk4QixlQUFlLENBQUNDLE9BQVFpQixFQUFvQnFELFFBQzdDeEYsTUFBTStELElBQ0xyQyxFQUFjNkMsSUFBTVIsRUFBSzdDLE9BQ3pCeUQsRUFBVzVDLE1BRVp6QixNQUFNRSxRQUFRQyxPQUNka0YsU0FBUSxLQUNQN0csRUFBa0JvSCxHQUFjLFNBcUh0Q3pDLEVBQW9CbkYsaUJBQWlCLFVBL0RONkgsS0FDN0IsTUFBTUMsRUFBZTdDLEVBQ3JCekUsRUFBa0JzSCxHQUFjLEVBQU0sU0FBVSxlQUVoRGpILEVBQUlrQyxXQUFXd0MsR0FDZDdELE1BQUssS0FDSjRELEVBQWExRyxTQUNieUgsRUFBV3RCLE1BRVovQyxNQUFNRSxRQUFRQyxPQUNka0YsU0FBUSxLQUNQN0csRUFBa0JzSCxHQUFjLEVBQU8sU0FBVSxxQkF1RHJEakgsRUFBSU8sYUFDRE0sTUFBSyxFQUFFcUcsRUFBT0MsTUFDYkQsRUFBTWpJLFNBQVNtSSxJQUNiLE1BQU1DLEVBQVMxQyxFQUFleUMsR0FDOUI1QyxFQUFVOEMsT0FBT0QsTUFFbkI3RSxFQUFZeEUsWUFBY21KLEVBQVMzRixLQUNuQ2lCLEVBQW1CekUsWUFBY21KLEVBQVMxRixNQUMxQ2MsRUFBYzZDLElBQU0rQixFQUFTcEYsVUFFOUJaLE1BQU1FLFFBQVFDLE9BR2pCMUMsRUFBaUI1QixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9hcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuLS1kaXNhYmxlZFwiLCBcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl9pbnB1dFwiLCBcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3ItLXZpc2libGVcIiwgXG4gIGVycm9yQ2xhc3NIaWRkZW46IFwibW9kYWxfX2Vycm9yLS1oaWRkZW5cIlxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBzZXR0aW5ncykgPT4ge1xuICBjb25zdCBpbnB1dEVsZW1lbnRTZWxlY3RvciA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH1gKTtcbiAgY29uc3QgaW5wdXRFcnJvckVsZW1lbnRJZCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudFNlbGVjdG9yLmlkfS1lcnJvcmApO1xuICBcbiAgaWYgKGlucHV0RXJyb3JFbGVtZW50SWQpIHtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmVycm9yQ2xhc3MpO1xuICAgIGlucHV0RXJyb3JFbGVtZW50SWQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIH1cbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGlucHV0RXJyb3JFbGVtZW50SWQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmVycm9yQ2xhc3MpO1xuXG4gIFxuICBpZiAoaW5wdXRFcnJvckVsZW1lbnRJZCkge1xuICAgIGlucHV0RXJyb3JFbGVtZW50SWQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsIHNldHRpbmdzKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncyk7XG4gIH1cbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbn07XG5cbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIFxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgc2V0dGluZ3MpO1xuICB9KTtcbiAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG59O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xuICBcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgc2V0dGluZ3MpO1xuICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cbmV4cG9ydCB7XG4gIHNldHRpbmdzLFxuICBzaG93SW5wdXRFcnJvcixcbiAgaGlkZUlucHV0RXJyb3IsXG4gIGNoZWNrSW5wdXRWYWxpZGl0eSxcbiAgaGFzSW52YWxpZElucHV0LFxuICBkaXNhYmxlQnV0dG9uLFxuICB0b2dnbGVCdXR0b25TdGF0ZSxcbiAgc2V0RXZlbnRMaXN0ZW5lcnMsXG4gIHJlc2V0VmFsaWRhdGlvbixcbiAgZW5hYmxlVmFsaWRhdGlvblxufTsiLCJleHBvcnQgZnVuY3Rpb24gc2V0U2F2ZUJ1dHRvblRleHQoXG4gICAgYnRuLCBcbiAgICBpc0xvYWRpbmcsXG4gICAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIiwgXG4gICAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSBcbntcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xuICAgIH1cbn07IiwiaW1wb3J0IHtcbiAgc2V0dGluZ3MsXG4gIHNob3dJbnB1dEVycm9yLFxuICBoaWRlSW5wdXRFcnJvcixcbiAgY2hlY2tJbnB1dFZhbGlkaXR5LFxuICBoYXNJbnZhbGlkSW5wdXQsXG4gIGRpc2FibGVCdXR0b24sXG4gIHRvZ2dsZUJ1dHRvblN0YXRlLFxuICBzZXRFdmVudExpc3RlbmVycyxcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBlbmFibGVWYWxpZGF0aW9uXG59IGZyb20gXCIvc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IHtzZXRTYXZlQnV0dG9uVGV4dH0gZnJvbSBcIi9zcmMvdXRpbHMvaGVscGVycy5qc1wiO1xuaW1wb3J0IFwiL3NyYy9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi9zcmMvdXRpbHMvYXBpLmpzXCI7XG5cbmNvbnN0IGFwaSA9ICBuZXcgQXBpKHsgXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMzA0ODdhNjQtNWY3MS00MWJiLWJiYmQtMmY3MjQwZWJjMGMyXCIsXG4gICAgXCJjb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IHByb2ZpbGVBZGRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5cbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWF2YXRhci1idG5cIik7XG5jb25zdCBhdmF0YXJNb2RhbEZvcm1FbGVtZW50ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBhdmF0YXJNb2RhbFVybElucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci11cmwtaW5wdXRcIik7XG5jb25zdCBhdmF0YXJNb2RhbFN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5cbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGVkaXRNb2RhbEZvcm1FbGVtZW50ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcbmNvbnN0IGVkaXRNb2RhbFN1Ym1pdEJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuXG5jb25zdCBhZGRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBhZGRNb2RhbEZvcm1FbGVtZW50ID0gYWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGFkZE1vZGFsQ2xvc2VCdG4gPSBhZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBhZGRNb2RhbENhcmRJbnB1dCA9IGFkZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcbmNvbnN0IGFkZE1vZGFsTmFtZUlucHV0ID0gYWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1uYW1lLWlucHV0XCIpO1xuY29uc3QgYWRkTW9kYWxTdWJtaXRCdG4gPSBhZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsZW1lbnQgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctY2FwdGlvblwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0bi0tcHJldmlld1wiKTtcblxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbENhbmNlbEJ0biA9IGRlbGV0ZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYW5jZWwtYnRuXCIpO1xuY29uc3QgZGVsZXRlQ2FyZE1vZGFsQnRuID0gZGVsZXRlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5jb25zdCBkZWxldGVDYXJkTW9kYWxDbG9zZUJ0biA9IGRlbGV0ZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBkZWxldGVDYXJkTW9kYWxGb3JtID0gZGVsZXRlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7IFxuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5sZXQgc2VsZWN0ZWRDYXJkO1xubGV0IHNlbGVjdGVkQ2FyZElkO1xuXG5jb25zdCBnZXRDYXJkRWxlbWVudCA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IGNhcmROYW1lRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBsaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcbiAgY29uc3QgZGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xuXG4gIGNhcmROYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZEltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xuXG4gIGxpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBoYW5kbGVMaWtlQnRuVG9nZ2xlKGV2dCwgZGF0YS5faWQpO1xuICB9KTtcblxuICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcbiAgfSk7XG5cbiAgZGVsZXRlQ2FyZE1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xuICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9KVxuXG4gIGRlbGV0ZUNhcmRNb2RhbENhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNsb3NlTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcbiAgfSlcblxuICBkZWxldGVDYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNsb3NlTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcbiAgfSlcbiAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSk7XG4gIH0pO1xuXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufTtcblxuXG4vL2hhbmRsZXJzXG5jb25zdCBoYW5kbGVFc2NhcGVLZXkgPSAoZXZ0KSA9PiB7XG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3QgYWN0aXZlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcbiAgICBpZiAoYWN0aXZlTW9kYWwpIHtcbiAgICAgIGNsb3NlTW9kYWwoYWN0aXZlTW9kYWwpO1xuICAgIH07XG4gIH07XG59O1xuXG5jb25zdCBoYW5kbGVPdmVybGF5Q2xpY2sgPSAoZXZ0KSA9PiB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH07XG59O1xuXG5jb25zdCBvcGVuTW9kYWwgPSAobW9kYWwpID0+IHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xpY2spO1xufTtcblxuY29uc3QgY2xvc2VNb2RhbCA9IChtb2RhbCkgPT4ge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XG59O1xuXG5jb25zdCBoYW5kbGVBdmF0YXJNb2RhbEZvcm1TdWJtaXQgPSAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBhdmF0YXJTdWJtaXQgPSBhdmF0YXJNb2RhbFN1Ym1pdEJ0bjtcbiAgc2V0U2F2ZUJ1dHRvblRleHQoYXZhdGFyU3VibWl0LCB0cnVlKTtcblxuICBhcGkuZWRpdFVzZXJBdmF0YXIoe2F2YXRhcjogYXZhdGFyTW9kYWxVcmxJbnB1dC52YWx1ZX0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFNhdmVCdXR0b25UZXh0KGF2YXRhclN1Ym1pdCwgZmFsc2UpO1xuICAgIH0pO1xufTtcblxuY29uc3QgaGFuZGxlRWRpdE1vZGFsRm9ybVN1Ym1pdCA9IChldnQpID0+IHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGVkaXRTdWJtaXQgPSBlZGl0TW9kYWxTdWJtaXRCdG47XG4gIHNldFNhdmVCdXR0b25UZXh0KGVkaXRTdWJtaXQsIHRydWUpO1xuXG4gIGFwaS5lZGl0VXNlckluZm8oe25hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSwgYWJvdXQ6IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWV9KVxuICAudGhlbigoZGF0YSkgPT4geyAgXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAuZmluYWxseSgoKSA9PiB7XG4gICAgc2V0U2F2ZUJ1dHRvblRleHQoZWRpdFN1Ym1pdCwgZmFsc2UpO1xuICB9KTtcblxufTtcblxuY29uc3QgaGFuZGxlQWRkTW9kYWxGb3JtU3VibWl0ID0gKGV2dCkgPT4ge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgYWRkU3VibWl0ID0gYWRkTW9kYWxTdWJtaXRCdG47XG4gIHNldFNhdmVCdXR0b25UZXh0KGFkZFN1Ym1pdCwgdHJ1ZSk7XG5cbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7IFxuICAgIG5hbWU6IGFkZE1vZGFsTmFtZUlucHV0LnZhbHVlLCBcbiAgICBsaW5rOiBhZGRNb2RhbENhcmRJbnB1dC52YWx1ZVxuICB9O1xuXG4gIGFwaS5jcmVhdGVDYXJkKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChuZXdDYXJkRGF0YSkgPT4ge1xuICAgICAgY29uc3QgYWRkQ2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChuZXdDYXJkRGF0YSk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChhZGRDYXJkRWxlbWVudCk7XG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICBjbG9zZU1vZGFsKGFkZE1vZGFsKTtcbiAgICAgIGRpc2FibGVCdXR0b24oYWRkTW9kYWxTdWJtaXRCdG4sIHNldHRpbmdzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBjYXJkOlwiLCBlcnJvcik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRTYXZlQnV0dG9uVGV4dChhZGRTdWJtaXQsIGZhbHNlKTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IGhhbmRsZURlbGV0ZUNhcmQgPSAoY2FyZEVsZW1lbnQsIGRhdGEpID0+IHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7IFxuICBvcGVuTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcbn07XG5cbmNvbnN0IGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQgPSAoKSA9PiB7XG4gIGNvbnN0IGRlbGV0ZVN1Ym1pdCA9IGRlbGV0ZUNhcmRNb2RhbEJ0bjtcbiAgc2V0U2F2ZUJ1dHRvblRleHQoZGVsZXRlU3VibWl0LCB0cnVlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuICBcbiAgYXBpLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gIC50aGVuKCgpID0+IHtcbiAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XG4gICAgY2xvc2VNb2RhbChkZWxldGVDYXJkTW9kYWwpO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgLmZpbmFsbHkoKCkgPT4ge1xuICAgIHNldFNhdmVCdXR0b25UZXh0KGRlbGV0ZVN1Ym1pdCwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG4gIH0pOyAgXG59O1xuXG5jb25zdCBoYW5kbGVMaWtlQnRuVG9nZ2xlID0gKGV2dCwgY2FyZElkKSA9PiB7ICBcbiAgY29uc3QgaXNMaWtlZCA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG4tbGlrZWRcIik7XG4gIGFwaS50b2dnbGVMaWtlQ2FyZChjYXJkSWQsIGlzTGlrZWQpXG4gICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bi1saWtlZFwiKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsaWtpbmcgY2FyZDpcIiwgZXJyb3IpO1xuICAgIH0pO1xufTtcblxuLy9ldmVudCBsaXN0ZW5lcnNcbmRlbGV0ZUNhcmRNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcbn0pXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xufSk7XG5wcm9maWxlQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChhZGRNb2RhbCk7IFxufSk7XG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XG4gIHJlc2V0VmFsaWRhdGlvbihlZGl0TW9kYWwsIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLCBlZGl0TW9kYWxTdWJtaXRCdG4sIHNldHRpbmdzKTtcbn0pO1xucHJldmlld01vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xufSk7XG5hZGRNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoYWRkTW9kYWwpO1xufSk7XG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG59KTtcbmF2YXRhck1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsKCkgID0+IHtcbiAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG59KTtcbmRlbGV0ZUNhcmRNb2RhbENhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGRlbGV0ZUNhcmRNb2RhbCk7XG59KVxuZGVsZXRlQ2FyZE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChkZWxldGVDYXJkTW9kYWwpO1xufSlcbmVkaXRNb2RhbEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdE1vZGFsRm9ybVN1Ym1pdCk7XG5hZGRNb2RhbEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkTW9kYWxGb3JtU3VibWl0KTtcbmF2YXRhck1vZGFsRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJNb2RhbEZvcm1TdWJtaXQpO1xuZGVsZXRlQ2FyZE1vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQpO1xuXG5cbmFwaS5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XG4gICAgY2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XG4gICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbCk7XG4gICAgfSk7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gdXNlckluZm8uYXZhdGFyO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG5cblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7ICIsImNsYXNzIEFwaSB7XG4gICAgY29uc3RydWN0b3Ioe2Jhc2VVcmwsIGhlYWRlcnN9KSB7XG4gICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cblxuICAgIGdldEFwcEluZm8oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VyQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XG4gICAgfVxuICAgIFxuXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsXG4gICAgICAgICAgICB7IFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgZWRpdFVzZXJJbmZvKHtuYW1lLCBhYm91dH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCxcbiAgICAgICAgICAgIHsgXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGFib3V0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfSAgIFxuICAgIFxuICAgIGVkaXRVc2VyQXZhdGFyKHthdmF0YXJ9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLFxuICAgICAgICAgICAgeyBcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgYXZhdGFyXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfSAgIFxuXG4gICAgZ2V0VXNlckNhcmRzKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLFxuICAgICAgICAgICAgeyBcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgIH0gICBcbiAgICBcbiAgICBjcmVhdGVDYXJkKHtuYW1lLCBsaW5rfSkgeyAgICAgICAgXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIiwgXG4gICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxpbmtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVtb3ZlQ2FyZChfaWQpIHsgICAgICAgIFxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtfaWR9YCxcbiAgICAgICAgICAgIHsgXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIFxuICAgIHRvZ2dsZUxpa2VDYXJkKF9pZCwgaXNMaWtlZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtfaWR9L2xpa2VzYCxcbiAgICAgICAgICAgIHsgXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgIH1cbiAgICAgICAgICAgIFxufVxuXG4gIGV4cG9ydCBkZWZhdWx0IEFwaTsiXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVycm9yQ2xhc3NIaWRkZW4iLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiaW5wdXRFcnJvckVsZW1lbnRJZCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiZGlzYWJsZUJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJhZGQiLCJkaXNhYmxlZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVsZW1lbnRTZWxlY3RvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJzZXRTYXZlQnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwibG9hZGluZ1RleHQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldFVzZXJDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiY3JlYXRlQ2FyZCIsImxpbmsiLCJyZW1vdmVDYXJkIiwiX2lkIiwidG9nZ2xlTGlrZUNhcmQiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBZGRCdG4iLCJwcm9maWxlRWRpdEJ0biIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxCdG4iLCJhdmF0YXJNb2RhbEZvcm1FbGVtZW50IiwiYXZhdGFyTW9kYWxDbG9zZUJ0biIsImF2YXRhck1vZGFsVXJsSW5wdXQiLCJhdmF0YXJNb2RhbFN1Ym1pdEJ0biIsImVkaXRNb2RhbCIsImVkaXRNb2RhbEZvcm1FbGVtZW50IiwiZWRpdE1vZGFsQ2xvc2VCdG4iLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwiZWRpdE1vZGFsU3VibWl0QnRuIiwiYWRkTW9kYWwiLCJhZGRNb2RhbEZvcm1FbGVtZW50IiwiYWRkTW9kYWxDbG9zZUJ0biIsImFkZE1vZGFsQ2FyZElucHV0IiwiYWRkTW9kYWxOYW1lSW5wdXQiLCJhZGRNb2RhbFN1Ym1pdEJ0biIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltYWdlRWxlbWVudCIsInByZXZpZXdNb2RhbENhcHRpb24iLCJwcmV2aWV3TW9kYWxDbG9zZUJ0biIsImRlbGV0ZUNhcmRNb2RhbCIsImRlbGV0ZUNhcmRNb2RhbENhbmNlbEJ0biIsImRlbGV0ZUNhcmRNb2RhbEJ0biIsImRlbGV0ZUNhcmRNb2RhbENsb3NlQnRuIiwiZGVsZXRlQ2FyZE1vZGFsRm9ybSIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiY2FyZEltYWdlRWxlbWVudCIsImxpa2VCdG4iLCJkZWxldGVCdG4iLCJzcmMiLCJhbHQiLCJoYW5kbGVMaWtlQnRuVG9nZ2xlIiwib3Blbk1vZGFsIiwiY2xvc2VNb2RhbCIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVFc2NhcGVLZXkiLCJrZXkiLCJhY3RpdmVNb2RhbCIsImhhbmRsZU92ZXJsYXlDbGljayIsInRhcmdldCIsImNvbnRhaW5zIiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2FyZElkIiwidXBkYXRlZENhcmQiLCJ0b2dnbGUiLCJ2YWx1ZSIsInJlc2V0VmFsaWRhdGlvbiIsImVkaXRTdWJtaXQiLCJmaW5hbGx5IiwiYWRkU3VibWl0IiwiaW5wdXRWYWx1ZXMiLCJuZXdDYXJkRGF0YSIsImFkZENhcmRFbGVtZW50IiwicHJlcGVuZCIsInJlc2V0IiwiYXZhdGFyU3VibWl0IiwiaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCIsImRlbGV0ZVN1Ym1pdCIsImNhcmRzIiwidXNlckluZm8iLCJpdGVtIiwiY2FyZEVsIiwiYXBwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==